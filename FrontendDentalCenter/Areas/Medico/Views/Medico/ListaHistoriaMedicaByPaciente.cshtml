@using FrontendDentalCenter.Areas.Medico.Models
@using FrontendDentalCenter.Models
@using FrontendDentalCenter.ViewModels
@{
    var Historia = ViewBag.HistoriaList as List<HistoriaMedicaViewModel>;
    var cabHistoia = ViewBag.CabHistoriaList as List<CabHistoriaMedicaViewModel>;
    var medicos = ViewBag.MedicoList as List<MedicoViewModel>;
    var Nombre = ViewBag.Nombres as string;
    var Apellido = ViewBag.Apellidos as string;
    
}

<table class="table table-striped" id="tbListadoHistoria">
    <thead>
        <tr>
            <th>Nombre del paciente</th>
            <th>Apellido del paciente</th>
            <th>Nombre del medico</th>
            <th>Apellido del medico</th>
            <th>Fecha de la cita</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        
        @for(int i = 0; i<Historia.Count();i++){
            <tr>
                <td>@Nombre</td>
                <td>@Apellido</td>
                <td>@medicos[i].Nombre</td>
                <td>@medicos[i].Apellido</td>
                <td>@cabHistoia[i].FechaDeActualizacion</td>
                <td>
                    <button class="btn btn-primary" onclick="loadModal()">Ver Historial</button>
                </td>
            </tr>
        }
    </tbody>
</table>


<!-- Modal -->
<div class="modal fade" id="modalVerHistorial" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Registro de Historial</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row">
                        <form class="formulario">
                            <fieldset class="dato-cliente">
                                <legend>DATOS DEL CLIENTE</legend>
                                <label>
                                    <span>NOMBRE:</span>
                                    <input type="text" readonly name="nombre">
                                </label>
                                <label for="">
                                    <span>Email:</span>
                                    <input type="email" readonly name="email">
                                </label>

                                <label for="">
                                    <span>Apellido:</span>
                                    <input type="text" readonly name="apellido">
                                </label>

                                <label for="">
                                    <span>Telefono:</span>
                                    <input type="text" readonly name="telefono">
                                </label>

                                <label for="">
                                    <span>DNI:</span>
                                    <input type="text" readonly name="dni">
                                </label>

                               <div class="dato-fechas">
                                <legend>FECHA</legend>
                                <label>
                                    <span>Fecha:</span>
                                    <input type="date" name="fecha">
                                </label>
                                <label>
                                    <span>Hora:</span>
                                    <input type="time" name="hora">
                                </label>
                              </div>
                            </fieldset>

                           

                            <fieldset class="dato-receta">
                                <legend>RECETA</legend>
                                <label>
                                    <span>Nombre:</span>
                                    <input type="text" name="nombre" readonly>
                                </label>
                                <label>
                                    <span>Apellido:</span>
                                    <input type="text" name="Apellido" readonly>
                                </label>
                                <label>
                                    <span>RUC:</span>
                                    <input type="text" name="ruc" readonly>
                                </label>
                                <div class="table">
                                    <table border>
                                        <thead>
                                            <tr>
                                                <th>Codigo</th>
                                                <th>Nombre</th>
                                                <th>Tipo</th>
                                                <th>Precio</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>-</td>
                                                <td>-</td>
                                                <td>-</td>
                                            </tr>
                                            <tr>
                                                <td>-</td>
                                                <td>-</td>
                                                <td>-</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <label class="observaciones">
                                    <span class="labelO">Observaciones</span>
                                    <textarea name="Observaciones" rows="10" class="observaciones"></textarea>
                                </label>
                            </fieldset>


                        </form>




                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<style>

    form {
        display: grid;
        grid-template-rows: auto;
        grid-template-columns: repeat(2,1fr);
        grid-auto-rows: auto;
        grid-gap: 14px;
    }

    body {
        font-family: arial narrow;
    }

    legend {
        font-size: 17px;
        font-weight: 900;
    }

    form .dato-cliente {
        grid-row: 1 / span 1;
    }

    form .dato-fecha {
        grid-row: 2 / span 1;
        grid-column: 1 / span 1;
    }
    
    

    form fieldset label {
        display: block;
        font-size: 17px;
        font-weight: 600;
        margin: 8px 0;
    }

        form fieldset label input {
            outline: none;
            padding: 5px;
        }

        form fieldset label span {
            width: 95px;
            display: inline-block;
        }

    form fieldset textarea {
        display: block;
    }

    form .dato-receta {
        grid-row: 1 / span 1;
    }

    form .botones {
        grid-row: 3 / span 1;
        grid-column: 1 / span 2;
        text-align: center;
    }

    form .b {
        grid-row: 3 / span 2;
        grid-column: 3 / span 15;
        text-align: center;
    }

    form .observaciones {
        grid-row: 4 / span 1;
        grid-column: 1 / span 2;
        text-align: center;
    }

        form .observaciones textarea {
            /* width: 200px !important; */
            width: 100%;
            resize: none;
        }

    form table {
        font-size: 18px;
        width: 200px;
    }

    form .table table thead tr th {
        width: 100px !important;
    }

    form .table {
        grid-row: 3 / span 1;
        grid-column: 1 / span 2;
        width: 100%;
        /* border: 2px solid red; */
        margin: auto;
    }

    .boton1, .boton2, .boton3, .boton4 {
        padding: 10px;
        border: none;
        font-size: 17px;
        color: #fff;
    }

    .boton1 {
        background-color: #a00;
        color: #fff;
    }

    .boton2 {
        padding: 10px;
        background-color: #0a0;
    }

    .boton3 {
        padding: 10px;
        background-color: #FFC733;
    }

    .boton4 {
        padding: 10px;
        background-color: #0a0;
    }

    form .ComBXM {
        grid-row: 3 / span 1;
        grid-column: 1 / span 5;
        margin: auto;
    }

    .ComBXM {
        padding: 10px;
        background-color: #fff;
    }

    .btn-group .btnM {
        background-color: #4CAF50; /* Green */
        border: 1px solid green;
        color: white;
        padding: 10px 45px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 12px;
        cursor: pointer;
        float: left;
    }

        .btn-group .btnM:not(:last-child) {
            border-right: none; /* Prevent double borders */
        }

        .btn-group .btnM:hover {
            background-color: #3e8e41;
        }

    .labelO {
        float: left
    }

</style>


<script>

   /* $("#btnVerHistorial").click(function () {
        var myModal = new bootstrap.Modal(document.getElementById('modalVerHistorial'));
        myModal.show();
    });*/

    loadDatatable();
    function loadDatatable() {
        //$("#tbListadoCliente").DataTable();
        let table = $("#tbListadoHistoriaMedica").DataTable({
            lengthChange: false,
            buttons: ['copy', 'excel', 'pdf', 'colvis', 'print']

        });

        table.buttons().container()
            .insertBefore("#tbListadoHistoriaMedica_filter");
    }

    function loadModal(){
        var myModal = new bootstrap.Modal(document.getElementById('modalVerHistorial'));
        myModal.show();
    }

</script>